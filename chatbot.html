<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support Chat - TerraGreen Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'terragreen': {
                            50: '#f0f9f4',
                            100: '#dcf2e3',
                            200: '#bce5ca',
                            300: '#8dd2a6',
                            400: '#57b87e',
                            500: '#339d63',
                            600: '#25804f',
                            700: '#1e6641',
                            800: '#1a5135',
                            900: '#16422d',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .sidebar {
            transition: all 0.3s ease;
        }
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.open {
                transform: translateX(0);
            }
        }
        .messages-container {
            height: calc(100vh - 220px);
        }
        .typing-indicator {
            display: inline-block;
            position: relative;
            width: 40px;
            height: 20px;
        }
        .typing-indicator span {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #339d63;
            animation: typing 1.4s infinite ease-in-out;
        }
        .typing-indicator span:nth-child(1) {
            left: 0;
            animation-delay: -0.32s;
        }
        .typing-indicator span:nth-child(2) {
            left: 12px;
            animation-delay: -0.16s;
        }
        .typing-indicator span:nth-child(3) {
            left: 24px;
        }
        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #339d63;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .dark .loader {
            border: 3px solid #374151;
            border-top: 3px solid #339d63;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <div class="flex h-screen">
        <div class="sidebar bg-white dark:bg-gray-800 w-64 shadow-md fixed h-full z-40 md:relative md:translate-x-0">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-terragreen-500 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-leaf text-white"></i>
                    </div>
                    <h1 class="text-xl font-bold text-gray-800 dark:text-white">TerraGreen Tracker</h1>
                </div>
            </div>
            
            <nav class="p-4">
                <ul class="space-y-2">
                    <li>
                        <a href="index.html" class="flex items-center p-3 text-gray-600 dark:text-gray-300 hover:bg-terragreen-50 dark:hover:bg-gray-700 hover:text-terragreen-600 dark:hover:text-terragreen-400 rounded-lg transition-colors">
                            <i class="fas fa-home mr-3"></i>
                            <span>Home</span>
                        </a>
                    </li>
                    <li>
                        <a href="dashboard.html" class="flex items-center p-3 text-gray-600 dark:text-gray-300 hover:bg-terragreen-50 dark:hover:bg-gray-700 hover:text-terragreen-600 dark:hover:text-terragreen-400 rounded-lg transition-colors">
                            <i class="fas fa-tachometer-alt mr-3"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    
                   <li>
                        <a href="imageaAnalytics.html" class="flex items-center p-3 text-gray-600 dark:text-gray-300 hover:bg-terragreen-50 dark:hover:bg-gray-700 hover:text-terragreen-600 dark:hover:text-terragreen-400 rounded-lg transition-colors">
                            <i class="fas fa-chart-bar mr-3"></i>
                            <span>Image Analytics</span>
                        </a>
                    </li>

                    <li>
                        <a href="environmentAnalytics.html" class="flex items-center p-3 text-gray-600 dark:text-gray-300 hover:bg-terragreen-50 dark:hover:bg-gray-700 hover:text-terragreen-600 dark:hover:text-terragreen-400 rounded-lg transition-colors">
                            <i class="fas fa-chart-bar mr-3"></i>
                            <span>Environment Analytics</span>
                        </a>
                    </li>
                    <li>
                        <a href="chatbot.html" class="flex items-center p-3 bg-terragreen-50 dark:bg-gray-700 text-terragreen-600 dark:text-terragreen-400 rounded-lg">
                            <i class="fas fa-robot mr-3"></i>
                            <span>Support Chat</span>
                        </a>
                    </li>
                </ul>
                
               <div class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-700">
                    <h3 class="text-xs uppercase text-gray-500 dark:text-gray-400 font-semibold mb-3 px-3">Account</h3>
                    <ul class="space-y-2">
                        
                        <li>
                            <a href="#" class="logout-button flex items-center p-3 text-gray-600 dark:text-gray-300 hover:bg-terragreen-50 dark:hover:bg-gray-700 hover:text-terragreen-600 dark:hover:text-terragreen-400 rounded-lg transition-colors">
                                <i class="fas fa-sign-out-alt mr-3"></i>
                                
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        
        <div class="flex-1 flex flex-col overflow-hidden md:ml-0">
            <header class="bg-white dark:bg-gray-800 shadow-sm py-4 px-6 flex items-center justify-between">
                <div class="flex items-center">
                    <button id="sidebar-toggle" class="md:hidden text-gray-600 dark:text-gray-300 mr-4">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <h2 class="text-xl font-semibold text-gray-800 dark:text-white"></h2>
                </div>
                
                <div class="flex items-center space-x-4">
                    <button id="dark-mode-toggle" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        <i class="fas fa-moon" id="dark-mode-icon"></i>
                    </button>
                    
                    <div class="relative">
                        <button id="notification-button" class="text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white">
                            <i class="fas fa-bell text-xl"></i>
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">3</span>
                        </button>
                        <!-- Notification Panel -->
                        <div id="notification-panel" class="hidden absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-xl shadow-lg border dark:border-gray-700 overflow-hidden">
                            <div class="p-4 border-b dark:border-gray-700">
                                <h3 class="font-semibold text-gray-800 dark:text-white">Notifications</h3>
                            </div>
                            <div class="divide-y dark:divide-gray-700">
                                <a href="#" class="flex p-4 items-start hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <div class="w-10 h-10 bg-red-100 dark:bg-red-900/50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                        <i class="fas fa-exclamation-triangle text-red-500 dark:text-red-400"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-800 dark:text-gray-200"><strong>High Risk Alert:</strong> Potential deforestation detected in Sector G-7.</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">15 minutes ago</p>
                                    </div>
                                </a>
                                <a href="#" class="flex p-4 items-start hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <div class="w-10 h-10 bg-yellow-100 dark:bg-yellow-900/50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                        <i class="fas fa-wifi-slash text-yellow-500 dark:text-yellow-400"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-800 dark:text-gray-200"><strong>Sensor Offline:</strong> Sensor #247 in the northern ridge is not responding.</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">2 hours ago</p>
                                    </div>
                                </a>
                                <a href="#" class="flex p-4 items-start hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <div class="w-10 h-10 bg-blue-100 dark:bg-blue-900/50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                        <i class="fas fa-cloud-download-alt text-blue-500 dark:text-blue-400"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-800 dark:text-gray-200"><strong>Report Ready:</strong> Your weekly summary for the Amazon Basin is ready for download.</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">1 day ago</p>
                                    </div>
                                </a>
                            </div>
                             
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-terragreen-500 rounded-full flex items-center justify-center text-white font-semibold mr-2 user-initials">
                            S
                        </div>
                        <span class="text-gray-700 dark:text-gray-300 user-name">Soham</span>
                    </div>
                </div>
            </header>
            
            <main class="flex-1 overflow-hidden p-6">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 h-full flex flex-col">
                    <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center">
                        <div class="w-10 h-10 bg-terragreen-100 dark:bg-terragreen-900/50 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-robot text-terragreen-600 dark:text-terragreen-400"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800 dark:text-white">TerraGreen AI Assistant</h3>
                            <p class="text-xs text-green-600 flex items-center">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-1"></span>
                                Online
                            </p>
                        </div>
                    </div>
                    
                    <div class="messages-container overflow-y-auto p-4 flex-1">
                        <div class="space-y-4" id="chat-messages">
                            <div class="flex items-start">
                                <div class="w-8 h-8 bg-terragreen-100 dark:bg-terragreen-900/50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                    <i class="fas fa-robot text-terragreen-600 dark:text-terragreen-400 text-sm"></i>
                                </div>
                                <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-3 max-w-xs md:max-w-md">
                                    <p class="text-gray-800 dark:text-gray-200">🌱 Hello! I'm TerraGreen AI — your intelligent environmental assistant. I can help you with reforestation, soil analysis, temperature monitoring, deforestation detection, and ecological analytics. How can I assist you today?</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">10:00 AM</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="w-8 h-8 bg-terragreen-100 dark:bg-terragreen-900/50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                    <i class="fas fa-robot text-terragreen-600 dark:text-terragreen-400 text-sm"></i>
                                </div>
                                <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-3 max-w-xs md:max-w-md">
                                    <p class="text-gray-800 dark:text-gray-200 mb-2">You can ask me about:</p>
                                    <div class="flex flex-wrap gap-2">
                                        <button class="quick-option px-3 py-1 bg-white dark:bg-gray-600 border border-terragreen-200 dark:border-gray-500 text-terragreen-600 dark:text-terragreen-300 rounded-full text-xs hover:bg-terragreen-50 dark:hover:bg-gray-500 transition-colors">Automated Reforestation</button>
                                        <button class="quick-option px-3 py-1 bg-white dark:bg-gray-600 border border-terragreen-200 dark:border-gray-500 text-terragreen-600 dark:text-terragreen-300 rounded-full text-xs hover:bg-terragreen-50 dark:hover:bg-gray-500 transition-colors">Soil Analysis</button>
                                        <button class="quick-option px-3 py-1 bg-white dark:bg-gray-600 border border-terragreen-200 dark:border-gray-500 text-terragreen-600 dark:text-terragreen-300 rounded-full text-xs hover:bg-terragreen-50 dark:hover:bg-gray-500 transition-colors">Temperature Data</button>
                                        <button class="quick-option px-3 py-1 bg-white dark:bg-gray-600 border border-terragreen-200 dark:border-gray-500 text-terragreen-600 dark:text-terragreen-300 rounded-full text-xs hover:bg-terragreen-50 dark:hover:bg-gray-500 transition-colors">Deforestation Detection</button>
                                    </div>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">10:01 AM</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                        <div class="flex space-x-2">
                            <input type="text" id="message-input" placeholder="Ask about reforestation, soil, temperature, or environmental monitoring..." class="flex-1 p-3 border border-gray-300 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-200 rounded-lg focus:ring-2 focus:ring-terragreen-500 focus:border-terragreen-500">
                            <button id="send-button" class="px-4 py-3 bg-terragreen-500 text-white rounded-lg hover:bg-terragreen-600 transition-colors">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-2 text-center">TerraGreen AI provides real-time environmental insights using advanced analytics.</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Mobile sidebar toggle
        document.getElementById('sidebar-toggle').addEventListener('click', function() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('open');
        });

        // Dark mode toggle
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const darkModeIcon = document.getElementById('dark-mode-icon');
        
        // Check for saved theme preference or respect OS preference
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            darkModeIcon.classList.remove('fa-moon');
            darkModeIcon.classList.add('fa-sun');
        } else {
            document.documentElement.classList.remove('dark');
            darkModeIcon.classList.remove('fa-sun');
            darkModeIcon.classList.add('fa-moon');
        }
        
        darkModeToggle.addEventListener('click', function() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
                darkModeIcon.classList.remove('fa-sun');
                darkModeIcon.classList.add('fa-moon');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
                darkModeIcon.classList.remove('fa-moon');
                darkModeIcon.classList.add('fa-sun');
            }
        });

        // Notification Panel
        const notificationButton = document.getElementById('notification-button');
        const notificationPanel = document.getElementById('notification-panel');

        notificationButton.addEventListener('click', (e) => {
            e.stopPropagation();
            notificationPanel.classList.toggle('hidden');
        });

        document.addEventListener('click', (e) => {
            if (!notificationPanel.contains(e.target) && !notificationButton.contains(e.target)) {
                notificationPanel.classList.add('hidden');
            }
        });
        
        // Advanced Chatbot with Gemini API Integration
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn !== 'true') {
                window.location.href = 'login.html';
                return;
            }

            const messageInput = document.getElementById('message-input');
            const sendButton = document.getElementById('send-button');
            const chatMessages = document.getElementById('chat-messages');
            const quickOptions = document.querySelectorAll('.quick-option');
            
            // Gemini API Configuration
            const GEMINI_API_KEY = ''; // Replace with your actual API key
            const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent';
            
            // Function to add a message to the chat
            function addMessage(text, isUser = false, isTyping = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `flex items-start ${isUser ? 'justify-end' : ''} my-4`;
                
                if (isUser) {
                    const userName = localStorage.getItem('userName') || 'User';
                    const userInitials = userName.split(' ').map(n => n[0]).join('').toUpperCase();
                    messageDiv.innerHTML = `
                        <div class="bg-terragreen-500 text-white rounded-lg p-3 max-w-xs md:max-w-md">
                            <p>${text}</p>
                            <p class="text-xs text-terragreen-200 mt-2 text-right">${getCurrentTime()}</p>
                        </div>
                        <div class="w-8 h-8 bg-terragreen-500 rounded-full flex items-center justify-center ml-3 flex-shrink-0 text-white font-semibold user-initials">
                            ${userInitials}
                        </div>
                    `;
                } else if (isTyping) {
                    messageDiv.innerHTML = `
                        <div class="w-8 h-8 bg-terragreen-100 dark:bg-terragreen-900/50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                            <i class="fas fa-robot text-terragreen-600 dark:text-terragreen-400 text-sm"></i>
                        </div>
                        <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-3 max-w-xs md:max-w-md">
                            <div class="typing-indicator">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    `;
                } else {
                    messageDiv.innerHTML = `
                        <div class="w-8 h-8 bg-terragreen-100 dark:bg-terragreen-900/50 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                            <i class="fas fa-robot text-terragreen-600 dark:text-terragreen-400 text-sm"></i>
                        </div>
                        <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-3 max-w-xs md:max-w-md">
                            <p class="text-gray-800 dark:text-gray-200">${text}</p>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">${getCurrentTime()}</p>
                        </div>
                    `;
                }
                
                chatMessages.appendChild(messageDiv);
                scrollToBottom();
                return messageDiv;
            }
            
            // Function to get current time in HH:MM format
            function getCurrentTime() {
                return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            }
            
            // Function to scroll to the bottom of the chat
            function scrollToBottom() {
                const messagesContainer = document.querySelector('.messages-container');
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // Function to call Gemini API
            async function callGeminiAPI(userMessage) {
                try {
                    // For demo purposes, we'll use a simulated response if no API key is provided
                    if (GEMINI_API_KEY === 'YOUR_GEMINI_API_KEY') {
                        return simulateGeminiResponse(userMessage);
                    }
                    
                    const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: `You are TerraGreen AI — an intelligent environmental assistant integrated into the TerraGreen Tracker platform.

Your purpose:
Provide accurate, insightful, and real-time responses to user queries about reforestation, environmental monitoring, deforestation detection, and ecological analytics.

Knowledge Scope:
- Automated and smart reforestation systems (drones, AI, IoT sensors)
- Soil moisture, fertility, and nutrient levels
- Temperature and humidity data interpretation
- Forest health monitoring
- Real-time satellite or sensor-based analysis
- Predictive modeling for deforestation risk
- Renewable sustainability insights
- Data displayed on TerraGreen Tracker dashboard and its features

Guidelines:
- Always respond in a helpful, factual, and professional tone.
- Use scientific accuracy, but keep language understandable for general users.
- If the query is not about TerraGreen, environment, or ecology, politely redirect.
- Include short real-time insights when relevant (e.g., "Based on current trends…").
- Keep responses concise but insightful (3–6 sentences max).
- When asked for data, simulate real-time values (e.g., soil moisture: 28.6%, temperature: 31°C, etc.).
- Use bullet points, emojis 🌱🌿🌍 when it improves readability.

User Query: "${userMessage}"

Please provide a helpful response as TerraGreen AI:`
                                }]
                            }]
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`API request failed with status ${response.status}`);
                    }
                    
                    const data = await response.json();
                    return data.candidates[0].content.parts[0].text;
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    return simulateGeminiResponse(userMessage);
                }
            }
            
            // Function to simulate Gemini responses for demo purposes
            function simulateGeminiResponse(userMessage) {
                const lowerUserMessage = userMessage.toLowerCase();
                
                // Simulate real-time environmental data
                const soilMoisture = (Math.random() * 40 + 10).toFixed(1);
                const temperature = (Math.random() * 15 + 20).toFixed(1);
                const humidity = (Math.random() * 40 + 50).toFixed(1);
                const deforestationRisk = (Math.random() * 30 + 10).toFixed(1);
                
                if (lowerUserMessage.includes('reforestation') || lowerUserMessage.includes('planting') || lowerUserMessage.includes('tree')) {
                    return `🌳 TerraGreen automates reforestation using drone technology and AI-powered analysis. Our system identifies optimal planting zones based on soil composition, moisture levels, and terrain data. Current reforestation efficiency has improved by 47% compared to manual methods. Based on recent analysis, areas with soil moisture above ${soilMoisture}% show 89% higher sapling survival rates.`;
                } else if (lowerUserMessage.includes('soil') || lowerUserMessage.includes('moisture') || lowerUserMessage.includes('fertility')) {
                    return `🌱 Current soil analysis shows moisture levels at ${soilMoisture}% with optimal nutrient distribution. Our sensors detect nitrogen levels at 2.8mg/kg and phosphorus at 1.2mg/kg. For healthy forest growth, maintain soil pH between 6.0-7.5. Recent data indicates that areas with higher organic matter content (≥3.5%) support 72% more biodiversity.`;
                } else if (lowerUserMessage.includes('temperature') || lowerUserMessage.includes('weather') || lowerUserMessage.includes('climate')) {
                    return `🌡️ Current environmental monitoring shows temperature at ${temperature}°C with ${humidity}% relative humidity. These conditions are optimal for temperate forest ecosystems. Based on predictive models, we expect a 0.8°C increase over the next month. Temperature variations beyond ±3°C from seasonal averages may indicate microclimate changes requiring attention.`;
                } else if (lowerUserMessage.includes('deforestation') || lowerUserMessage.includes('forest loss') || lowerUserMessage.includes('clear cutting')) {
                    return `🚨 Deforestation risk assessment currently shows ${deforestationRisk}% probability in monitored regions. Our satellite imagery detects 12.8 hectares of potential forest cover loss this quarter. Key indicators include reduced canopy density (-18%) and increased soil erosion patterns. Immediate intervention recommended for sectors G-7 and H-4 where risk exceeds 25%.`;
                } else if (lowerUserMessage.includes('sensor') || lowerUserMessage.includes('monitoring') || lowerUserMessage.includes('data')) {
                    return `📊 TerraGreen's sensor network provides real-time environmental data across 342 monitoring stations. Current system status: 94% operational with 18 sensors in maintenance. Data accuracy: ±2% for soil metrics, ±0.5°C for temperature. Recent upgrades have improved data transmission latency by 67%, enabling faster response to environmental changes.`;
                } else if (lowerUserMessage.includes('dashboard') || lowerUserMessage.includes('analytics') || lowerUserMessage.includes('report')) {
                    return `📈 The TerraGreen dashboard displays real-time environmental metrics including forest health indices, carbon sequestration rates, and biodiversity scores. Current forest health index: 84/100 (Good). Carbon capture this month: 2,847 tons. You can customize your dashboard to show specific metrics like soil composition trends or deforestation alerts.`;
                } else if (lowerUserMessage.includes('help') || lowerUserMessage.includes('support') || lowerUserMessage.includes('what can you do')) {
                    return `🌍 I'm TerraGreen AI, your environmental monitoring assistant! I can help you with:
• Automated reforestation insights
• Soil and temperature analysis  
• Deforestation risk assessment
• Sensor network status
• Dashboard data interpretation
• Environmental trend predictions

Just ask about any TerraGreen Tracker feature or environmental metric!`;
                } else {
                    return `I specialize in TerraGreen environmental monitoring topics like reforestation, soil analysis, and deforestation detection. Could you please ask about our environmental monitoring systems, sensor data, or forest conservation efforts? 🌿`;
                }
            }
            
            // Function to send message and get AI response
            async function sendMessage() {
                const message = messageInput.value.trim();
                if (message) {
                    // Add user message
                    addMessage(message, true);
                    messageInput.value = '';
                    
                    // Show typing indicator
                    const typingIndicator = addMessage('', false, true);
                    
                    // Get AI response
                    const aiResponse = await callGeminiAPI(message);
                    
                    // Remove typing indicator and add AI response
                    typingIndicator.remove();
                    addMessage(aiResponse, false);
                }
            }
            
            // Event listeners
            sendButton.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Quick option buttons
            quickOptions.forEach(button => {
                button.addEventListener('click', function() {
                    const optionText = this.textContent;
                    messageInput.value = optionText;
                    sendMessage();
                });
            });
            
            // Add logout functionality
            document.querySelectorAll('.logout-button').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('userEmail');
                    localStorage.removeItem('userName');
                    window.location.href = 'login.html';
                });
            });
            
            // Update user info from localStorage
            const userName = localStorage.getItem('userName');
            if (userName) {
                const userInitials = userName.split(' ').map(n => n[0]).join('').toUpperCase();
                document.querySelectorAll('.user-initials').forEach(el => {
                    el.textContent = userInitials;
                });
                document.querySelectorAll('.user-name').forEach(el => {
                    el.textContent = userName;
                });
            }

            // Initial scroll to bottom
            scrollToBottom();
        });
    </script>
</body>
</html>
